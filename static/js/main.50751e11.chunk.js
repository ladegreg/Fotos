(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,n){e.exports=n(39)},22:function(e,t,n){},24:function(e,t,n){},26:function(e,t,n){},28:function(e,t,n){},30:function(e,t,n){},32:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(14),o=n.n(r),c=(n(22),n(5)),i=n(6),s=n(8),u=n(7),m=n(9),d=n(42),h=n(43),f=n(41),E=n(40),p=(n(24),l.a.createContext({token:null,userId:null,login:function(e,t,n){},logout:function(){}})),v=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={isLogin:!0},n.switchModeHandler=function(){n.setState(function(e){return{isLogin:!e.isLogin}})},n.submitHandler=function(e){e.preventDefault();var t=n.emailEl.current.value,a=n.passwordEl.current.value;if(0!==t.trim().length&&0!==a.trim().length){var l={query:'\n        query {\n          login(email:"'.concat(t,'", password: "').concat(a,'") {\n            userId\n            token\n            tokenExpiration\n          }\n        }\n      ')};n.state.isLogin||(l={query:'\n        mutation {\n          createUser(userInput: {email: "'.concat(t,'", password: "').concat(a,'"}) {\n            _id\n            email\n          }\n        }\n        ')}),fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(l),headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()}).then(function(e){e.data.login.token&&n.context.login(e.data.login.token,e.data.login.userId,e.data.login.tokenExpiration)}).catch(function(e){console.log(e)})}},n.emailEl=l.a.createRef(),n.passwordEl=l.a.createRef(),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("form",{className:"auth-forms",onSubmit:this.submitHandler},l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"email"}," E-Mail "),l.a.createElement("input",{type:"email",id:"email",ref:this.emailEl})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"password"}," Password "),l.a.createElement("input",{type:"password",id:"password",ref:this.passwordEl})),l.a.createElement("div",{className:"form-actions"},l.a.createElement("button",{type:"submit"},"Submit"),l.a.createElement("button",{type:"button",onClick:this.switchModeHandler},"Switch to ",this.state.isLogin?"Signup":"Login"))))}}]),t}(a.Component);v.contextType=p;var g=v,b=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("h1",null,"the Bookings page ")}}]),t}(a.Component),k=(n(26),function(e){return l.a.createElement("div",{className:"modal"},l.a.createElement("header",{className:"modal__header"},e.title),l.a.createElement("section",{className:"modal__content"},e.children),l.a.createElement("section",{className:"modal__actions"},e.canCancel&&l.a.createElement("button",{className:"btn",onClick:e.onCancel},"Cancel"),e.canConfirm&&l.a.createElement("button",{className:"btn",onClick:e.onConfirm},"Confirm")))}),y=(n(28),function(e){return l.a.createElement("div",{className:"backdrop"})}),C=(n(30),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={creating:!1,events:[]},n.startCreateEventHandler=function(){n.setState({creating:!0})},n.modalConfirmHandler=function(){n.setState({creating:!1});var e=n.titleElRef.current.value,t=+n.priceElRef.current.value,a=n.dateElRef.current.value,l=n.descriptionElRef.current.value;if(!(0===e.trim().length||t<=0||0===a.trim().length||0===l.trim().length)){var r={title:e,price:t,date:a,description:l};console.log(r);var o={query:'\n          mutation {\n            createEvent(eventInput: {title: "'.concat(e,'", description: "').concat(l,'", price: ').concat(t,', date: "').concat(a,'"}) {\n              _id\n              title\n              description\n              date\n              price\n            }\n          }\n        ')},c=n.context.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()}).then(function(e){n.fetchEvents()}).catch(function(e){console.log(e)})}},n.modalCancelHandler=function(){n.setState({creating:!1})},n.titleElRef=l.a.createRef(),n.priceElRef=l.a.createRef(),n.dateElRef=l.a.createRef(),n.descriptionElRef=l.a.createRef(),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchEvents()}},{key:"fetchEvents",value:function(){var e=this;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify({query:"\n          query {\n            events {\n              _id\n              title\n              description\n              date\n              price\n            }\n          }\n        "}),headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()}).then(function(t){var n=t.data.events;e.setState({events:n})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this.state.events.map(function(e){return l.a.createElement("li",{key:e._id,className:"events__list-item"},e.title)});return l.a.createElement(l.a.Fragment,null,this.state.creating&&l.a.createElement(y,null),this.state.creating&&l.a.createElement(k,{title:"Add Event",canCancel:!0,canConfirm:!0,onCancel:this.modalCancelHandler,onConfirm:this.modalConfirmHandler},l.a.createElement("form",null,l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"title"},"Title"),l.a.createElement("input",{type:"text",id:"title",ref:this.titleElRef})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"price"},"Price"),l.a.createElement("input",{type:"number",id:"price",ref:this.priceElRef})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"date"},"Date"),l.a.createElement("input",{type:"datetime-local",id:"date",ref:this.dateElRef})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"description"},"Description"),l.a.createElement("textarea",{id:"description",rows:"4",ref:this.descriptionElRef})))),this.context.token&&l.a.createElement("div",{className:"events-control"},l.a.createElement("p",null,"Share your own Events!"),l.a.createElement("button",{className:"btn",onClick:this.startCreateEventHandler},"Create Event")),l.a.createElement("ul",{className:"events__list"},e))}}]),t}(a.Component));C.contextType=p;var w=C,N=n(44),j=(n(32),function(e){return l.a.createElement(p.Consumer,null,function(e){return l.a.createElement("header",{className:"main-navigation"},l.a.createElement("div",{className:"main-navigation_logo"},l.a.createElement("h1",null,"The NavBar ")),l.a.createElement("nav",{className:"main-navigation_item"},l.a.createElement("ul",null,!e.token&&l.a.createElement("li",null,l.a.createElement(N.a,{to:"/auth"},"Authenticate")),l.a.createElement("li",null,l.a.createElement(N.a,{to:"/events"},"Events")),e.token&&l.a.createElement(l.a.Fragment,null,l.a.createElement("li",null,l.a.createElement(N.a,{to:"/bookings"},"Bookings")),l.a.createElement("li",null,l.a.createElement("button",{onClick:e.logout},"Logout"))))))})}),O=(n(37),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,l=new Array(a),r=0;r<a;r++)l[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={token:null,userId:null},n.login=function(e,t,a){n.setState({token:e,userId:t})},n.logout=function(){n.setState({token:null,userId:null})},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement(d.a,null,l.a.createElement(l.a.Fragment,null,l.a.createElement(p.Provider,{value:{token:this.state.token,userId:this.state.userId,login:this.login,logout:this.logout}},l.a.createElement(j,null),l.a.createElement("main",{className:"main-content"},l.a.createElement(h.a,null,this.state.token&&l.a.createElement(f.a,{from:"/",to:"/events",exact:!0}),this.state.token&&l.a.createElement(f.a,{from:"/auth",to:"/events",exact:!0}),!this.state.token&&l.a.createElement(E.a,{path:"/auth",component:g}),l.a.createElement(E.a,{path:"/events",component:w}),this.state.token&&l.a.createElement(E.a,{path:"/bookings",component:b}),!this.state.token&&l.a.createElement(f.a,{to:"/auth",exact:!0}))))))}}]),t}(a.Component));o.a.render(l.a.createElement(O,null),document.getElementById("root"))}},[[16,2,1]]]);
//# sourceMappingURL=main.50751e11.chunk.js.map